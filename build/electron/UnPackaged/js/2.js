(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"065a":function(t,e,a){},"0bc3":function(t,e,a){},"0cb2e":function(t,e,a){},1883:function(t,e,a){},"2ed2":function(t,e,a){"use strict";a("6703")},"31c7":function(t,e,a){"use strict";a("39d8")},"39d8":function(t,e,a){},"643c":function(t,e,a){"use strict";a("92c4")},6703:function(t,e,a){},"69e6":function(t,e,a){},"8dde":function(t,e,a){},"92c4":function(t,e,a){},"966a":function(t,e,a){"use strict";a("0cb2e")},ba79:function(t,e,a){"use strict";a("8dde")},beaa:function(t,e,a){"use strict";a("69e6")},db4f:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"page",attrs:{padding:""}},[t.loading?a("div",{staticClass:"center-wrapper column justify-center items-center"},[a("p",[a("q-spinner",{staticClass:" q-mb-lg",attrs:{size:"xl"}}),a("span",{staticClass:"text-h4 text-bold q-ml-md"},[t._v(t._s(t.$t("account_loading")))])],1)]):"signedIn"!==t.$store.state.account.authState?a("div",{staticClass:"center-wrapper column justify-center items-center"},["signedOut"===t.$store.state.account.authState?a("signed-out",{ref:"signedOut"}):"signInConfirm"===t.$store.state.account.authState?a("sign-in-confirm"):"forgotPassword"===t.$store.state.account.authState?a("forgot-password"):"signUp"===t.$store.state.account.authState?a("sign-up"):"signUpConfirm"===t.$store.state.account.authState?a("sign-up-confirm"):t._e(),"test"===t.$store.state.account.authState?a("test-card"):t._e()],1):t._e()])},i=[],s=(a("a79d"),a("d9e2"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("account-card",{ref:"card",attrs:{vertical:"",title:t.$t("account_sign_in_your_account"),"force-hide-cancel":!t.phoneMode},on:{submit:t.handleSubmit,cancel:function(e){t.phoneMode=!1}},scopedSlots:t._u([{key:"default",fn:function(){return[t.phoneMode?t._l(t.vmPhoneMode.items,(function(e,n,i){return a("alphabiz-input",{key:n,attrs:{autofocus:0===i,readonly:t.loading||t.oauthLoading,required:"","hide-not-say":!0,type:e.data.type,icon:e.data.icon,label:e.data.label,rules:e.data.rules},on:{enter:t.pressEnter},model:{value:t.vmPhoneMode.items[n].model,callback:function(e){t.$set(t.vmPhoneMode.items[n],"model",e)},expression:"vmPhoneMode.items[key].model"}})})):t._l(t.vm.items,(function(e,n,i){return a("alphabiz-input",{key:n,attrs:{autofocus:0===i,readonly:t.loading||t.oauthLoading,required:"",type:e.data.type,icon:e.data.icon,label:e.data.label},on:{enter:t.pressEnter},model:{value:t.vm.items[n].model,callback:function(e){t.$set(t.vm.items[n],"model",e)},expression:"vm.items[key].model"}})})),a("p",{staticClass:"q-pl-sm q-pt-lg q-pb-xs text-grey-7"},[t._v(t._s(t.$t("account_forgot_your_password"))),a("a",{staticClass:"reset-pwd text-primary q-ml-xs cursor-pointer",attrs:{disabled:t.loading||t.oauthLoading},on:{click:function(e){!t.loading&&!t.oauthLoading&&t.$store.commit("ACCOUNT_UPDATE_STATE","forgotPassword")}}},[t._v(t._s(t.$t("account_reset_password")))])])]},proxy:!0},{key:"actions",fn:function(){return[a("account-card-button",{ref:"submitButton",attrs:{loading:t.loading,disable:t.loading||t.oauthLoading,type:"submit",label:t.$t("account_sign_in"),primary:""}}),a("account-card-button",{attrs:{disable:t.loading||t.oauthLoading,label:t.$t("account_sign_up"),grey:""},on:{click:function(e){return t.$store.commit("ACCOUNT_UPDATE_STATE","signUp")}}}),a("account-card-button",{attrs:{grey:"",disable:t.loading,label:"test"},on:{click:t.test}}),a("q-separator",{staticClass:"q-mb-xs q-mt-sm",staticStyle:{padding:"0",height:"0.5px"}}),a("OAuthLinkConfirmDialog",{attrs:{oauthData:t.oauthData},on:{cancel:function(){return t.oauthStatus="cancel"}},model:{value:t.showOAuthLinkConfirmDialog,callback:function(e){t.showOAuthLinkConfirmDialog=e},expression:"showOAuthLinkConfirmDialog"}}),a("OAuthSignUpDialog",{attrs:{oauthData:t.oauthData},on:{cancel:function(){return t.oauthStatus="cancel"},success:function(){return t.oauthSignIn(t.oauthData.providerName)}},model:{value:t.showOAuthSignUpDialog,callback:function(e){t.showOAuthSignUpDialog=e},expression:"showOAuthSignUpDialog"}}),t._l(t.oauthLabels,(function(e,n){return a("account-card-button",{key:n,attrs:{grey:"",loading:t.oauthProvider===n&&t.oauthLoading,disable:t.loading||t.oauthLoading,label:e},on:{click:function(e){return t.oauthSignIn(n)}}})}))]},proxy:!0}])})}),o=[],r=a("48f4"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.oauthData?a("alphabiz-dialog",{ref:"signUpDialog",attrs:{"max-width":"360px",value:t.value,title:t.$t("account_sign_up"),"on-submit":t.onSignUp,"on-cancel":t.onSignUpCancel,"on-clear":t.onSignUpClear},on:{input:function(e){return t.$emit("input",e)}},scopedSlots:t._u([{key:"description",fn:function(){return[t._v("\n    【Test Invitation Code】: 5EPD12NW3F\n    "),a("br"),t._v("\n    当前"+t._s(t.oauthData.providerName)+"账户所对应的邮箱："+t._s(t.oauthData.providerInfo.email)+"尚未创建账户\n  ")]},proxy:!0},{key:"default",fn:function(e){var n=e.disable;return[t._l(t.vm.items,(function(e,i,s){return a("alphabiz-input",{key:i,staticStyle:{width:"309px"},attrs:{autofocus:0===s,required:"",type:e.data.type,icon:e.data.icon,label:e.data.label,rules:e.data.rules,readonly:n},model:{value:t.vm.items[i].model,callback:function(e){t.$set(t.vm.items[i],"model",e)},expression:"vm.items[key].model"}})})),t.oauthData?a("alphabiz-dialog",{attrs:{"max-width":"360px",title:t.$t("account_verify_your_identity"),"on-submit":t.onVerify,"on-cancel":t.onVerifyCancel,"on-clear":t.onVerifyClear},scopedSlots:t._u([{key:"description",fn:function(){return[t._v("\n        一封附带验证码的电子邮件已发送至邮箱："+t._s(t.oauthData.providerInfo.email)+"\n      ")]},proxy:!0},{key:"default",fn:function(e){var n=e.disable;return t._l(t.vm2.items,(function(e,i,s){return a("alphabiz-input",{key:i,staticStyle:{width:"309px"},attrs:{autofocus:0===s,required:"",type:e.data.type,icon:e.data.icon,label:e.data.label,rules:e.data.rules,readonly:n},model:{value:t.vm2.items[i].model,callback:function(e){t.$set(t.vm2.items[i],"model",e)},expression:"vm2.items[key].model"}})}))}}],null,!0),model:{value:t.showVerifyDialog,callback:function(e){t.showVerifyDialog=e},expression:"showVerifyDialog"}}):t._e()]}}],null,!1,2993252854)}):t._e()},l=[],u=(a("e9c4"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{attrs:{value:t.value,persistent:t.persistent},on:{input:function(e){return t.$emit("input",e)}}},[a("q-card",{staticClass:"alphabiz-dialog column",style:Object.assign({},{minWidth:"342px"},t.maxWidth?{maxWidth:t.maxWidth}:{})},[a("q-card-section",{staticClass:"q-px-lg q-pt-lg q-pb-sm"},[a("div",{staticClass:"text-h5 text-weight-bold q-pb-md"},[t._v(t._s(t.title))]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.$slots.description,expression:"$slots.description"}],staticStyle:{width:"100%",overflow:"hidden"}},[t._t("description",null,{loading:t.loading,disable:t.disable})],2)]),a("q-form",{staticClass:"col-grow column",on:{submit:t.handleSubmit}},[a("q-card-section",{staticClass:"col-grow q-px-lg q-pt-none q-pb-lg q-gutter-y-lg"},[t._t("default",null,{disable:t.disable})],2),a("q-separator",{staticClass:"q-mx-none"}),a("q-card-actions",{staticClass:"q-px-lg q-py-md",attrs:{align:"stretch",vertical:""}},[t.onSubmit?a("q-btn",{staticClass:"bg-primary text-white q-mb-xs",attrs:{flat:"",size:"md",type:"submit",label:t.submitLabel,percentage:t.percentage,disable:t.disable||t.loading,loading:t.loading},scopedSlots:t._u([{key:"loading",fn:function(){return[a("q-spinner",{attrs:{color:"white"}})]},proxy:!0}],null,!1,2648522201)}):t._e(),t.cancel?a("q-btn",{staticClass:"normal-button",attrs:{flat:"",label:t.cancelLabel,size:"md",disable:t.disable},on:{click:t.handleCancel}}):t._e()],1)],1)],1)],1)}),d=[],h=(a("ddb0"),{name:"AlphabizDialog",props:{value:Boolean,persistent:{type:Boolean,default:!1},title:{type:String,default:"Title"},maxWidth:{type:String,default:""},cancel:{type:Boolean,default:!0},submitLabel:{type:String,default(){return this.$t("account_submit")}},cancelLabel:{type:String,default(){return this.$t("account_cancel")}},timeout:{type:Object,default:null},onSubmit:{type:Function,default:null},onCancel:{type:Function,default:null},onClear:{type:Function,default:null}},data(){return{percentage:100,interval:null,disable:!1,loading:!1}},watch:{value(t){!t&&this.onClear&&setTimeout((()=>this.onClear()),400)}},methods:{async handleSubmit(){try{const t=this.timeout?this.timerWrapper(this.onSubmit,this.timeout.onTimeout,this.timeout.duration):this.onSubmit;this.disable=!0,this.loading=!0;const e=await t();e&&this.$emit("input",!1)}finally{this.loading=!1,this.disable=!1}},async handleCancel(){if(this.onCancel)try{this.disable=!0;const t=await this.onCancel();t&&this.$emit("input",!1)}finally{this.disable=!1}else this.$emit("input",!1)},timerWrapper(t,e,a){const n=100,i=Math.max(100,a/100),s=Math.max(1,Math.floor(i)/a*n);this.percentage=0;let o=!1;const r=()=>new Promise(((t,e)=>{this.interval=setInterval((()=>{this.percentage=Math.max(0,Math.min(100,this.percentage+s)),this.percentage>=100&&(clearInterval(this.interval),setTimeout((()=>{o?t():e(new Error("Timeout"))}),1e3))}),i)})),c=()=>new Promise((t=>{this.percentage<100&&(o=!0,clearInterval(this.interval),this.percentage=100,setTimeout(t,1e3))}));return async function(...a){let n;return await Promise.race([r(),t.apply(this,a)]).then((t=>{n=t})).catch((t=>{if("Timeout"!==t.message)throw t;e()})).finally((()=>{c()})),n}}},beforeDestroy(){clearInterval(this.interval)}}),m=h,p=(a("ba79"),a("2877")),g=a("24e8"),f=a("f09f"),v=a("a370"),b=a("0378"),y=a("eb85"),_=a("4b7e"),w=a("9c40"),C=a("0d59"),$=a("eebe"),S=a.n($),x=Object(p["a"])(m,u,d,!1,null,null,null),D=x.exports;S()(x,"components",{QDialog:g["a"],QCard:f["a"],QCardSection:v["a"],QForm:b["a"],QSeparator:y["a"],QCardActions:_["a"],QBtn:w["a"],QSpinner:C["a"]});var k=a("8e4e"),A=a("5723"),q={name:"OAuthSignUpDialog",components:{AlphabizDialog:D,AlphabizInput:k["c"]},props:{value:{type:Boolean},oauthData:{type:Object}},data(){return{vm:new r["d"],vm2:new r["e"],showVerifyDialog:!1,username:null,password:null,oauthStatus:"cancel"}},methods:{onSignUpClear(){this.vm.clearData(),this.username=null,this.password=null,this.oauthStatus="cancel"},onSignUpCancel(){return window.open(process.env.OAUTH_LOGOUT_URL),this.$emit(this.oauthStatus),!0},async onSignUp(){const t={oauthSignUp:"true",oauthData:JSON.stringify({providerName:this.oauthData.providerName,providerUserId:this.oauthData.providerUserId}),email:this.oauthData.providerInfo.email,...this.vm.formData};return await Object(A["o"])(t).then((e=>{this.username=e.user.username,this.password=t.password,console.log("res sign up",e),this.showVerifyDialog=!0}),(({message:t})=>{r["c"].showNegative(t),this.$refs.signUpDialog.handleCancel()})),!1},onVerifyClear(){this.vm2.clearData()},onVerifyCancel(){return setTimeout((()=>this.$refs.signUpDialog.handleCancel()),100),!0},async onVerify(){const{code:t}=this.vm2.formData;return await Object(A["c"])(this.username,t,{},{oauthSignUp:"true",oauthData:JSON.stringify({providerName:this.oauthData.providerName,providerUserId:this.oauthData.providerUserId})}).then((()=>{setTimeout((()=>{this.oauthStatus="success",this.$refs.signUpDialog.handleCancel()}),100)}),(({message:t})=>{setTimeout((()=>this.$refs.signUpDialog.handleCancel()),100),r["c"].showNegative(t),console.log("error:",t)})),!0}}},M=q,T=Object(p["a"])(M,c,l,!1,null,null,null),O=T.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{class:t.containerClz.concat(["account-card"]),attrs:{flat:"",bordered:""}},[t.$listeners.cancel&&!t.forceHideCancel?a("q-btn",{staticClass:"self-start",staticStyle:{height:"48px"},attrs:{flat:"",icon:"arrow_back",disable:t.cancelDisable},on:{click:function(e){return t.$emit("cancel")}}}):t._e(),t.title?a("q-card-section",{class:t.headerClz.concat(["header"])},[a("div",{staticClass:"col-auto row no-wrap justify-end"},[a("div",{staticClass:"col-grow text-h5 text-bold"},[t._v(t._s(t.title))]),t._t("options")],2),a("div",{directives:[{name:"show",rawName:"v-show",value:t.description,expression:"description"}],staticClass:"description q-ml-xs"},[t._v(t._s(t.description))])]):t._e(),t.$listeners.submit?a("q-form",{ref:"form",class:[t.formWrapperClz,"form-wrapper"],on:{submit:t.handleSubmit,reset:function(e){return t.$emit("reset")}}},[a("q-card-section",{class:(t.vertical?t.contentColClz:t.contentRowClz).concat(["content"])},[t._t("default")],2),t.$slots.actions?a("q-separator",{staticClass:"q-mx-none"}):t._e(),t.$slots.actions?a("q-card-actions",{class:t.actionsClz.concat(["actions"]),attrs:{vertical:t.vertical}},[t._t("actions")],2):t._e()],1):t._e(),t.$listeners.submit?t._e():[a("q-card-section",{class:(t.vertical?t.contentColClz:t.contentRowClz).concat(["content"])},[t._t("default")],2),t.$slots.actions?a("q-separator",{staticClass:"q-mx-none"}):t._e(),t.$slots.actions?a("q-card-actions",{class:t.actionsClz.concat(["actions"]),attrs:{vertical:t.vertical}},[t._t("actions")],2):t._e()]],2)},V=[],E={name:"AccountCard",props:{title:String,description:String,vertical:Boolean,forceHideCancel:Boolean,cancelDisable:Boolean},methods:{submit(){this.$listeners.submit&&this.$refs.form&&this.$refs.form.submit()},handleSubmit(){this.$emit("submit")}},computed:{containerClz(){return["column","justify-start","items-stretch",this.vertical?"col-card":"row-card"]},headerClz(){return["q-col-gutter-y-md","q-mx-lg","q-px-sm",this.$listeners.cancel?"":"q-pt-lg"]},formWrapperClz(){return[this.vertical?"col-card":"row-card"]},contentColClz(){return["q-col-gutter-y-lg","q-mx-lg","q-px-sm","q-pb-lg"]},contentRowClz(){return["q-col-gutter-y-lg","q-col-gutter-x-md","q-mx-md","q-pl-none","q-pt-sm","row","justify-start","items-center"]},actionsClz(){return["q-col-gutter-y-xs","q-mb-xs","q-pt-md","q-pb-sm","q-mx-lg","q-px-sm",this.vertical?"":"row justify-end"]}}},N=E,I=(a("966a"),Object(p["a"])(N,U,V,!1,null,null,null)),P=I.exports;S()(I,"components",{QCard:f["a"],QBtn:w["a"],QCardSection:v["a"],QForm:b["a"],QSeparator:y["a"],QCardActions:_["a"]});var z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-btn",{staticClass:"border",class:t.primary?"bg-primary text-white":!t.outline&&t.grey?"account_normal_btn":"",staticStyle:{"min-width":"96px",width:"100%"},attrs:{disable:t.disable||t.loading,loading:t.loading,size:"md",align:"around",flat:!t.outline,outline:t.outline,type:t.type,"no-wrap":"",percentage:t.percentage},on:{click:t.handleClick},scopedSlots:t._u([{key:"loading",fn:function(){return[a("q-spinner",{attrs:{color:t.primary?"white":""}})]},proxy:!0}])},[t._v("\n    "+t._s(t.label)+"\n    ")])],1)},B=[],j={name:"AccountCardButton",props:{primary:Boolean,disable:Boolean,outline:Boolean,loading:Boolean,grey:Boolean,label:{type:String,default:"button"},type:{type:String,default:"button"}},data(){return{percentage:100,interval:null}},methods:{handleClick(t){this.$emit("click",t,this)},startTimer(t,e){return new Promise((a=>{const n=100,i=Math.max(100,t/100),s=Math.max(1,Math.floor(i)/t*n);this.percentage=0,e(!0),this.interval=setInterval((()=>{this.percentage=Math.max(0,Math.min(100,this.percentage+s)),this.percentage>=100&&(clearInterval(this.interval),setTimeout((()=>{e(!1),a()}),1e3))}),i)}))},shutdownTimer(t){return new Promise(((e,a)=>{this.percentage>=100?a():(this.percentage=100,clearInterval(this.interval),setTimeout((()=>{t(!1),e()}),1e3))}))}},beforeDestroy(){clearInterval(this.interval)}},L=j,F=(a("beaa"),Object(p["a"])(L,z,B,!1,null,"896d84bc",null)),Q=F.exports;S()(F,"components",{QBtn:w["a"],QSpinner:C["a"]});var R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.oauthData?a("alphabiz-dialog",{attrs:{"max-width":"360px",value:t.value,title:t.$t("account_verify_your_identity"),"on-submit":t.onConfirm,"on-cancel":t.onCancel,"on-clear":t.onClear},on:{input:function(e){return t.$emit("input",e)}},scopedSlots:t._u([{key:"description",fn:function(){return[t._v("\n    一封附带验证码的电子邮件已发送至当前"+t._s(t.oauthData.providerName)+"账户所对应的邮箱："+t._s(t.oauthData.providerInfo.email)+"\n  ")]},proxy:!0},{key:"default",fn:function(e){var n=e.disable;return t._l(t.vm.items,(function(e,i,s){return a("alphabiz-input",{key:i,staticStyle:{width:"309px"},attrs:{autofocus:0===s,required:"",type:e.data.type,icon:e.data.icon,label:e.data.label,rules:e.data.rules,readonly:n},model:{value:t.vm.items[i].model,callback:function(e){t.$set(t.vm.items[i],"model",e)},expression:"vm.items[key].model"}})}))}}],null,!1,1844177628)}):t._e()},W=[],G={name:"OAuthLinkConfirmDialog",components:{AlphabizDialog:D,AlphabizInput:k["c"]},data(){return{vm:new r["k"]}},props:{value:{type:Boolean},oauthData:{type:Object}},methods:{onCancel(){return window.open(process.env.OAUTH_LOGOUT_URL),this.$emit("cancel"),!0},onClear(){this.vm.clearData()},async onConfirm(){const t={...this.vm.formData};return console.log("on confirm",t),!1}}},H=G,J=Object(p["a"])(H,R,W,!1,null,"90c2e60c",null),K=J.exports,X=a("bf82");const Y=6e4;var Z={name:"SignedOut",components:{OAuthLinkConfirmDialog:K,AccountCard:P,AccountCardButton:Q,AlphabizInput:k["c"],OAuthSignUpDialog:O},data(){return{loading:!1,phoneMode:!1,vm:new r["h"],vmPhoneMode:(new r["g"]).setDefaultValue(),oauthProvider:null,oauthStatus:null,oauthData:null,oauthLabels:{Facebook:"sign in with facebook",Google:"sign in with google",Github:"sign in with github"},showOAuthSignUpDialog:!1,showOAuthLinkConfirmDialog:!1}},watch:{oauthStatus(t){"cancel"===t?(this.oauthProvider=null,this.oauthStatus=null):"success"===t?r["a"].redirectToIndex().finally((()=>{this.oauthProvider=null,this.oauthStatus=null})):"signUp"===t?this.showOAuthSignUpDialog=!0:"confirm"===t&&(this.showOAuthLinkConfirmDialog=!0)},phoneMode(t){t?(this.vmPhoneMode.items.phoneNumber.model[1]=this.vm.items.username.model,this.vm.clearData()):(this.vm.items.username.model=this.vmPhoneMode.items.phoneNumber.model[1],this.vmPhoneMode.setDefaultValue())}},computed:{oauthLoading(){return null!==this.oauthStatus}},methods:{pressEnter(){this.loading||this.oauthLoading||this.$refs.card.submit()},handleSubmit(){this.phoneMode?this.signInPhoneMode():this.signIn()},async signIn(){const t=this.$refs.submitButton,e=t=>this.loading=t;t.startTimer(Y,e).then((()=>r["c"].showNegative("Network error")));const a=this.vm.formData;try{await r["a"].signIn(a.username,a.password),await t.shutdownTimer(e),r["a"].updateState("signedIn"),r["c"].showPositive("signed_in")}catch(n){await t.shutdownTimer(e);const a=n.message;"SMS_MFA"===a||"SOFTWARE_TOKEN_MFA"===a?r["a"].updateState("signInConfirm"):"UserNotConfirmedException"===a?r["a"].updateState("signUpConfirm"):"User does not exist."===a?(r["c"].showNegative("Incorrect username or password."),this.vm.isPhoneNumberWithoutPrefix&&(this.phoneMode=!0)):r["c"].showNegative(a)}},async signInPhoneMode(){const t=this.$refs.submitButton,e=t=>this.loading=t;t.startTimer(Y,e).then((()=>r["c"].showNegative("Network error")));const a=this.vmPhoneMode.formData;try{await r["a"].signIn(a.phoneNumber,a.password),await t.shutdownTimer(e),r["a"].updateState("signedIn"),r["c"].showPositive("signed_in")}catch(n){await t.shutdownTimer(e);const a=n.message;"SMS_MFA"===a||"SOFTWARE_TOKEN_MFA"===a?r["a"].updateState("signInConfirm"):"UserNotConfirmedException"===a?r["a"].updateState("signUpConfirm"):"User does not exist."===a?r["c"].showNegative("Incorrect username or password."):r["c"].showNegative(a)}},async oauthSignIn(t){this.setOAuthStatus("pending",t),await X["a"].launchOAuth("signedOut",{provider:t})},setOAuthStatus(t,e,a){e&&(this.oauthProvider=e),a&&(this.oauthData=a),this.oauthStatus=t},test(){}}},tt=Z,et=(a("dddf"),Object(p["a"])(tt,s,o,!1,null,"6d3e1068",null)),at=et.exports;S()(et,"components",{QSeparator:y["a"]});var nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("account-card",{ref:"card",attrs:{vertical:"",title:t.$t(["account_find_your_account","account_reset_your_password"][t.progress]),"cancel-disable":t.searching||t.verifying,description:[t.$t("account_enter_your_username"),t.verifyDescription][t.progress]},on:{cancel:t.cancel,submit:function(){[t.search,t.verify][t.progress]()}},scopedSlots:t._u([t.progress?t.progress?{key:"default",fn:function(){return t._l(t.verificationVM.items,(function(e,n,i){return a("alphabiz-input",{key:n,attrs:{readonly:t.searching||t.verifying,required:"",autofocus:0===i,type:e.data.type,icon:e.data.icon,label:e.data.label,rules:e.data.rules},on:{enter:t.pressEnter},model:{value:t.verificationVM.items[n].model,callback:function(e){t.$set(t.verificationVM.items[n],"model",e)},expression:"verificationVM.items[key].model"}})}))},proxy:!0}:null:{key:"default",fn:function(){return[a("alphabiz-input",{staticClass:"q-mt-md",attrs:{autofocus:"",readonly:t.searching,required:"",type:t.usernameVM.data.type,icon:t.usernameVM.data.icon,label:t.usernameVM.data.label},on:{enter:t.pressEnter},model:{value:t.usernameVM.model,callback:function(e){t.$set(t.usernameVM,"model",e)},expression:"usernameVM.model"}})]},proxy:!0},{key:"actions",fn:function(){return[a("account-card-button",{attrs:{disable:t.searching||t.verifying,label:t.$t(["account_search","account_submit"][t.progress]),loading:[t.searching,t.verifying][t.progress],type:"submit",primary:""}}),1===t.progress?a("account-card-button",{attrs:{disable:t.verifying,label:t.$t("account_resend_code"),loading:t.searching,grey:""},on:{click:t.search}}):t._e()]},proxy:!0}],null,!0)})},it=[],st={name:"ForgotPassword",components:{AccountCard:P,AccountCardButton:Q,AlphabizInput:k["c"]},data(){const t=new r["b"];return{usernameVM:t.usernameVM,verificationVM:t.verificationVM,progress:0,searching:!1,verifying:!1,username:"",verificationCode:"",newPwd:"",newPwd2:""}},computed:{verifyDescription(){return this.$store.state.account.verification?{email:`${this.$t("account_email_sent_tip")}${this.$store.state.account.verification.destination}`,phone_number:`${this.$t("account_phone_sent_tip")}${this.$store.state.account.verification.destination}`}[this.$store.state.account.verification.type]:this.$t("account_tip_verified")}},methods:{pressEnter(){this.searching||this.verifying||this.$refs.card.submit()},search(){this.searching=!0,r["a"].forgotPasswordSend(this.usernameVM.value).then((()=>{0===this.progress?this.progress+=1:r["c"].showPositive("code_has_been_resent")})).catch((t=>r["c"].showNegative(t.message))).finally((()=>this.searching=!1))},verify(){this.verifying=!0;const t=this.verificationVM.formData;r["a"].forgotPasswordSubmit(t.verificationCode,t.password).then((()=>{r["c"].showPositive("password_has_been_reset"),this.progress=-1})).catch((t=>r["c"].showNegative(t.message))).finally((()=>this.verifying=!1))},cancel(){this.progress-=1}},watch:{progress(t,e){t<0&&this.$store.commit("ACCOUNT_UPDATE_STATE","signedOut")}}},ot=st,rt=(a("f29a"),Object(p["a"])(ot,nt,it,!1,null,"7abda965",null)),ct=rt.exports,lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row justify-center items-center",staticStyle:{width:"100%",height:"100%"}},[0===t.progress?a("sign-up-necessary",{on:{cancel:t.cancel,next:t.next}}):t._e(),1===t.progress?a("sign-up-optional",{on:{cancel:t.cancel,next:t.cancel}}):t._e()],1)},ut=[],dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("account-card",{ref:"card",staticStyle:{width:"100%"},attrs:{vertical:"","cancel-disable":t.registering,title:t.$t("account_sign_up_your_account")+" (1/2)",description:t.$t("account_fill_required_fields")},on:{cancel:function(e){return t.$emit("cancel")},submit:t.register},scopedSlots:t._u([{key:"default",fn:function(){return[t._l(t.vm.items,(function(e,n,i){return a("div",{key:n},[a("alphabiz-input",{attrs:{autofocus:0===i,required:"",readonly:t.registering,type:e.data.type,icon:e.data.icon,label:e.data.label,rules:e.data.rules,"hide-not-say":""},on:{enter:t.pressEnter},model:{value:t.vm.items[n].model,callback:function(e){t.$set(t.vm.items[n],"model",e)},expression:"vm.items[key].model"}})],1)})),a("div",[a("p",{staticClass:"q-pl-sm switch-tip text-grey-7"},[t._v(t._s(t.$t(t.usePhone?"account_no_phone_number":"account_no_email"))),a("a",{staticClass:"switch-text text-primary q-ml-xs cursor-pointer",attrs:{disabled:t.registering},on:{click:function(e){!t.registering&&(t.usePhone=!t.usePhone)}}},[t._v(t._s(t.$t(t.usePhone?"account_sign_up_by_email":"account_sign_up_by_phone_number")))])])])]},proxy:!0},{key:"actions",fn:function(){return[a("div",{staticClass:"col-grow q-mb-sm row items-center"},[a("q-checkbox",{attrs:{disable:t.registering,label:t.$t("account_i_accept")},model:{value:t.accept,callback:function(e){t.accept=e},expression:"accept"}}),a("div",{staticClass:"license cursor-pointer text-primary",attrs:{disabled:t.registering},on:{click:t.showLicense}},[t._v(t._s(t.$t("account_license_terms"))+"\n      ")])],1),a("div",[t._v("Test Invitation Code: 5EPD12NW3F")]),a("account-card-button",{staticClass:"q-pb-sm",attrs:{loading:t.registering,primary:"",type:"submit",label:t.$t("account_next")}})]},proxy:!0}])})},ht=[],mt={name:"SignUpNecessary",components:{AccountCard:P,AccountCardButton:Q,AlphabizInput:k["c"]},data(){return{accept:!1,registering:!1,usePhone:!0,vm:(new r["j"]).setDefaultValue()}},watch:{usePhone(t){this.vm=t?(new r["j"]).setDefaultValue():(new r["i"]).setDefaultValue()}},methods:{pressEnter(){this.registering||this.$refs.card.submit()},register(){if(!this.accept)return void r["c"].showNegative("you_need_to_accept_license_terms");this.registering=!0;const t=this.vm.formData;r["a"].signUpNecessary(t).then((()=>this.$emit("next"))).catch((t=>r["c"].showNegative(t.message))).finally((()=>this.registering=!1))},showLicense(){r["c"].showRaw("showing license")}}},pt=mt,gt=(a("2ed2"),a("8f8e")),ft=Object(p["a"])(pt,dt,ht,!1,null,"ea4f2cd8",null),vt=ft.exports;S()(ft,"components",{QCheckbox:gt["a"]});var bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("account-card",{ref:"card",staticStyle:{width:"100%"},attrs:{vertical:"","cancel-disable":t.resending||t.changing,title:t.$t("account_verify_fill_optional_fields")+" (2/2)",description:t.description},on:{cancel:function(e){return t.$emit("cancel")},submit:t.submit},scopedSlots:t._u([{key:"default",fn:function(){return[a("div",{staticClass:"verification-wrapper",staticStyle:{width:"100%"}},[a("alphabiz-input",{staticClass:"input",attrs:{readonly:t.changing,autofocus:"",type:t.verificationCodeVM.data.type,icon:t.verificationCodeVM.data.icon,label:t.verificationCodeVM.data.label+" *",required:t.verificationCodeVM.data.label,rules:t.verificationCodeVM.data.rules},on:{enter:t.pressEnter},model:{value:t.verificationCodeVM.model,callback:function(e){t.$set(t.verificationCodeVM,"model",e)},expression:"verificationCodeVM.model"}}),a("account-card-button",{staticClass:"button",attrs:{disable:t.changing,label:t.$t("account_resend_code"),loading:t.resending,grey:""},on:{click:t.resend}})],1),t._l(t.vm.items,(function(e,n){return["select"===e.type?a("alphabiz-select",{key:n,attrs:{readonly:t.changing,options:e.data.options,"item-max-width":"locale"===n?286:0},on:{enter:t.pressEnter},model:{value:t.vm.items[n].model,callback:function(e){t.$set(t.vm.items[n],"model",e)},expression:"vm.items[key].model"}}):"input"===e.type?a("alphabiz-input",{key:n,attrs:{readonly:t.changing,type:e.data.type,icon:e.data.icon,title:e.data.title,label:e.data.label,rules:e.data.rules},on:{enter:t.pressEnter},model:{value:t.vm.items[n].model,callback:function(e){t.$set(t.vm.items[n],"model",e)},expression:"vm.items[key].model"}}):t._e()]}))]},proxy:!0},{key:"actions",fn:function(){return[a("account-card-button",{ref:"submitButton",attrs:{disable:t.resending,loading:t.changing,primary:"",type:"submit",label:t.$t("account_finish")}})]},proxy:!0}])})},yt=[],_t=a("2cb1"),wt={name:"SignUpOptional",components:{AccountCard:P,AccountCardButton:Q,AlphabizInput:k["c"],AlphabizSelect:_t["b"]},data(){return{verificationCodeVM:new r["k"],vm:(new r["f"]).setDefaultValue(),changing:!1,resending:!1,verificationCode:""}},computed:{description(){return this.$store.state.account.verification?{email:`${this.$t("account_email_sent_tip")}${this.$store.state.account.verification.destination}`,phone_number:`${this.$t("account_phone_sent_tip")}${this.$store.state.account.verification.destination}`}[this.$store.state.account.verification.type]:this.$t("account_tip_verified")}},methods:{pressEnter(){this.resending||this.changing||this.$refs.card.submit()},submit(){const t=this.$refs.submitButton,e=t=>this.changing=t;t.startTimer(3e4,e).then((()=>{r["c"].showNegative("Network error")})),r["a"].signUpVerificationCodeSubmit(this.verificationCodeVM.value,this.vm.formData).then((()=>{t.shutdownTimer(e).then((()=>{r["a"].updateState("signedIn"),r["c"].showPositive("signed_up")}))})).catch((({message:a})=>{t.shutdownTimer(e).then((()=>r["c"].showNegative(a)))}))},resend(){this.resending=!0,r["a"].signUpVerificationCodeResend().then((t=>r["c"].showPositive("code_has_been_resent"))).catch((t=>{this.error=t.message,r["c"].showNegative(t.message)})).finally((()=>this.resending=!1))}}},Ct=wt,$t=(a("f28c"),Object(p["a"])(Ct,bt,yt,!1,null,"20ddd464",null)),St=$t.exports,xt={name:"SignUp",components:{SignUpNecessary:vt,SignUpOptional:St},data(){return{progress:0}},methods:{next(){this.progress+=1},cancel(){this.$store.commit("ACCOUNT_UPDATE_STATE","signedOut")}}},Dt=xt,kt=Object(p["a"])(Dt,lt,ut,!1,null,null,null),At=kt.exports,qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("account-card",{ref:"card",attrs:{title:t.$t("account_verify_your_identity"),description:t.verifyDescription,vertical:"","cancel-disable":t.resending||t.verifying},on:{cancel:t.cancel,submit:t.verify},scopedSlots:t._u([{key:"default",fn:function(){return[a("alphabiz-input",{attrs:{readonly:t.resending||t.verifying,type:t.vm.data.type,autofocus:"",required:"",icon:t.vm.data.icon,label:t.vm.data.label,rules:t.vm.data.rules},on:{enter:t.pressEnter},model:{value:t.vm.model,callback:function(e){t.$set(t.vm,"model",e)},expression:"vm.model"}})]},proxy:!0},{key:"actions",fn:function(){return[a("account-card-button",{ref:"submitButton",attrs:{disable:t.resending,label:t.$t("account_submit"),loading:t.verifying,type:"submit",primary:""}}),a("account-card-button",{attrs:{disable:t.verifying,label:t.$t("account_resend_code"),loading:t.resending,grey:""},on:{click:t.resend}})]},proxy:!0}])})},Mt=[],Tt={name:"SignUpVerificationCode",components:{AccountCard:P,AccountCardButton:Q,AlphabizInput:k["c"]},data(){return{vm:new r["k"],verifying:!1,resending:!1}},mounted(){r["c"].showRaw("Test")},computed:{verifyDescription(){return this.$store.state.account.verification?{email:`${this.$t("account_email_sent_tip")}${this.$store.state.account.verification.destination}`,phone_number:`${this.$t("account_phone_sent_tip")}${this.$store.state.account.verification.destination}`}[this.$store.state.account.verification.type]:this.$t("account_tip_verified")}},methods:{pressEnter(){this.verifying||this.resending||this.$refs.card.submit()},verify(){const t=this.$refs.submitButton,e=t=>this.verifying=t;t.startTimer(3e4,e).then((()=>{r["c"].showNegative("Network error")})),r["a"].signUpVerificationCodeSubmit(this.vm.value).then((()=>{t.shutdownTimer(e).then((()=>{r["a"].updateState("signedIn"),r["c"].showPositive("signed_in")}))})).catch((({message:a})=>{t.shutdownTimer(e).then((()=>r["c"].showNegative(a)))}))},resend(){this.resending=!0,r["a"].signUpVerificationCodeResend().then((()=>r["c"].showPositive("code_has_been_resent"))).catch((t=>r["c"].showNegative(t.message))).finally((()=>this.resending=!1))},cancel(){this.$store.commit("ACCOUNT_UPDATE_STATE","signedOut")}}},Ot=Tt,Ut=Object(p["a"])(Ot,qt,Mt,!1,null,null,null),Vt=Ut.exports,Et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("account-card",{ref:"card",attrs:{title:t.$t("account_verify_your_identity"),description:t.verifyDescription,vertical:"","cancel-disable":t.resending||t.verifying},on:{cancel:t.cancel,submit:t.verify},scopedSlots:t._u([{key:"default",fn:function(){return[a("alphabiz-input",{attrs:{readonly:t.resending||t.verifying,type:t.vm.data.type,autofocus:"",required:"",icon:t.vm.data.icon,label:t.vm.data.label,rules:t.vm.data.rules},on:{enter:t.pressEnter},model:{value:t.vm.model,callback:function(e){t.$set(t.vm,"model",e)},expression:"vm.model"}}),a("p",{staticClass:"q-pl-sm q-pt-lg q-pb-xs text-grey-7"},[t._v(t._s(t.$t("account_can_not_mfa"))),a("a",{staticClass:"hover-underline text-primary q-ml-xs cursor-pointer",attrs:{disabled:t.verifying||t.resending},on:{click:t.handleDisableMFA}},[t._v(t._s(t.$t("account_disable_mfa")))]),a("disable-m-f-a-dialog",{model:{value:t.showDisableMFADialog,callback:function(e){t.showDisableMFADialog=e},expression:"showDisableMFADialog"}})],1)]},proxy:!0},{key:"actions",fn:function(){return[a("account-card-button",{ref:"submitButton",attrs:{disable:t.resending,label:t.$t("account_submit"),loading:t.verifying,type:"submit",primary:""}}),"software_token"!==t.$store.state.account.verification.type?a("account-card-button",{attrs:{disable:t.verifying,label:t.$t("account_resend_code"),loading:t.resending,grey:""},on:{click:t.resend}}):t._e()]},proxy:!0}])})},Nt=[],It=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("alphabiz-dialog",{attrs:{value:t.value,title:t.$t("account_disable_mfa"),"max-width":"360px","on-submit":t.onSubmit,"on-clear":t.onClear},on:{input:function(e){return t.$emit("input",e)}},scopedSlots:t._u([{key:"description",fn:function(){return[0===t.disableStep?[a("div",[t._v("向当前账户的email和手机号码发送验证码以验证您的身份")])]:t._e(),1===t.disableStep?[a("div",[t._v("附带验证码的电子邮件和手机短信已分别发送到您的邮箱和手机：\n        "),a("div",[t._v(t._s(t.verificationData.email.destination))]),a("div",[t._v(t._s(t.verificationData.phoneNumber.destination))])])]:t._e()]},proxy:!0},1===t.disableStep?{key:"default",fn:function(e){var n=e.disable;return[a("alphabiz-input",{staticStyle:{width:"309px"},attrs:{required:"",autofocus:"",readonly:n,type:t.emailCodeVM.data.type,icon:t.emailCodeVM.data.icon,label:t.emailCodeVM.data.label,rules:t.emailCodeVM.data.rules},model:{value:t.emailCodeVM.model,callback:function(e){t.$set(t.emailCodeVM,"model",e)},expression:"emailCodeVM.model"}}),a("alphabiz-input",{staticStyle:{width:"309px"},attrs:{required:"",autofocus:"",readonly:n,type:t.phoneCodeVM.data.type,icon:t.phoneCodeVM.data.icon,label:t.phoneCodeVM.data.label,rules:t.phoneCodeVM.data.rules},model:{value:t.phoneCodeVM.model,callback:function(e){t.$set(t.phoneCodeVM,"model",e)},expression:"phoneCodeVM.model"}})]}}:null],null,!0)})},Pt=[],zt={name:"DisableMFADialog",components:{AlphabizDialog:D,AlphabizInput:k["c"]},props:{value:{type:Boolean}},data(){return{disableStep:0,verificationData:null,emailCodeVM:new r["k"],phoneCodeVM:new r["k"]}},watch:{value(t){t&&console.log("data",this.$store.state.account.verification)}},methods:{onClear(){this.disableStep=0,this.verificationData=null,this.emailCodeVM.clearData(),this.phoneCodeVM.clearData()},async onSubmit(){return await this[["sendCodes","submitCodes"][this.disableStep]]()},async sendCodes(){try{const{user:{username:t}}=this.$store.state.account.verification;this.verificationData=await Object(A["k"])(t),this.disableStep+=1}catch(t){r["c"].showNegative(t.message)}return!1},async submitCodes(){try{const{user:{username:t},password:e}=this.$store.state.account.verification,a={username:t,password:e,emailCode:this.emailCodeVM.value,phoneCode:this.phoneCodeVM.value};console.log(a);const n=await Object(A["v"])(t,a.emailCode,a.phoneCode);return console.log(n),this.$store.commit("ACCOUNT_UPDATE_STATE","signedOut"),r["c"].showRaw("disable mfa success"),!0}catch(t){return r["c"].showNegative(t.message),!1}}}},Bt=zt,jt=Object(p["a"])(Bt,It,Pt,!1,null,null,null),Lt=jt.exports,Ft={name:"SignInConfirm",components:{AccountCard:P,AccountCardButton:Q,AlphabizInput:k["c"],DisableMFADialog:Lt},data(){return{vm:new r["k"],verifying:!1,resending:!1,showDisableMFADialog:!1}},computed:{verifyDescription(){return this.$store.state.account.verification?{email:`${this.$t("account_email_sent_tip")}${this.$store.state.account.verification.destination}`,phone_number:`${this.$t("account_phone_sent_tip")}${this.$store.state.account.verification.destination}`,software_token:`${this.$t("account_software_token_tip")}`}[this.$store.state.account.verification.type]:this.$t("account_tip_verified")}},methods:{pressEnter(){this.verifying||this.resending||this.$refs.card.submit()},verify(){const t=this.$refs.submitButton,e=t=>this.verifying=t;t.startTimer(3e4,e).then((()=>r["c"].showNegative("Network error"))),r["a"].mfaSubmit(this.vm.value).then((()=>{t.shutdownTimer(e).then((()=>{r["a"].updateState("signedIn"),r["c"].showPositive("signed_in")}))})).catch((({message:a})=>t.shutdownTimer(e).then((()=>{r["c"].showNegative(a)}))))},resend(){this.resending=!0,r["a"].mfaResend().then((()=>r["c"].showPositive("code_has_been_resent"))).catch((t=>r["c"].showNegative(t.message))).finally((()=>this.resending=!1))},cancel(){this.$store.commit("ACCOUNT_UPDATE_STATE","signedOut")},handleDisableMFA(){this.showDisableMFADialog=!this.showDisableMFADialog}}},Qt=Ft,Rt=(a("643c"),Object(p["a"])(Qt,Et,Nt,!1,null,"ded391d2",null)),Wt=Rt.exports,Gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("account-card",{staticStyle:{width:"360px"},attrs:{vertical:"",title:"Test Card"},on:{cancel:t.cancel,submit:t.onSubmit,reset:t.onReset},scopedSlots:t._u([{key:"default",fn:function(){},proxy:!0},{key:"actions",fn:function(){return[a("account-card-button",{attrs:{type:"submit",label:"Submit",primary:""}}),a("account-card-button",{attrs:{type:"reset",label:"Reset"}})]},proxy:!0}])}),a("alphabiz-dialog",{attrs:{title:"Title",timeout:{duration:4e3,onTimeout:t.handleTimeout},onSubmit:t.handleSubmit},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.disable;return[a("div",[t._v(t._s(n))])]}}]),model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}})],1)},Ht=[],Jt={name:"TestCard",components:{AccountCard:P,AccountCardButton:Q,AlphabizDialog:D},data(){return{showDialog:!1}},methods:{async handleSubmit(){console.log("start"),await new Promise((t=>{setTimeout(t,1e4)})),console.log("finished")},handleTimeout(){console.log("time o")},cancel(){r["a"].redirectToIndex()},onSubmit(){this.showDialog=!0},onReset(){r["c"].showRaw("onReset")}}},Kt=Jt,Xt=Object(p["a"])(Kt,Gt,Ht,!1,null,null,null),Yt=Xt.exports,Zt=a("98d0"),te={name:"Account",components:{SignedOut:at,ForgotPassword:ct,SignUp:At,SignUpConfirm:Vt,SignInConfirm:Wt,TestCard:Yt},data(){return{loading:!0}},watch:{"$store.state.account.authState"(t){"signedIn"===t&&this.$router.push("/account/settings")}},beforeRouteEnter(t,e,a){a((e=>{t.query.code||t.query.error_description?e.onOAuthInit():e.onNativeInit()}))},methods:{onNativeInit(){this.$store.state.account.authState?this.loading=!1:(this.loading=!0,r["a"].redirectToIndex().finally((()=>this.loading=!1)))},onOAuthInit(){const{fullPath:t,query:e}=this.$route,a=t.split("?")[1],n=e.error_description;Object(Zt["a"])(a,n,((t,e,a)=>{"link"===t?(this.loading=!0,r["a"].redirectToIndex().finally((()=>{if(this.loading=!1,"signedIn"!==this.$store.state.account.authState)throw new Error("Unexpected Condition: OAuthLinkedEvent is triggered but the authState is not signedIn")}))):(this.loading=!1,this.$store.commit("ACCOUNT_UPDATE_STATE","signedOut"),setTimeout((()=>this.$refs.signedOut.setOAuthStatus(t,e,a))))}),{label:"WEB_RECEIVED"})}}},ee=te,ae=(a("31c7"),a("9989")),ne=Object(p["a"])(ee,n,i,!1,null,"fbcd29f0",null);e["default"]=ne.exports;S()(ne,"components",{QPage:ae["a"],QSpinner:C["a"]})},dddf:function(t,e,a){"use strict";a("0bc3")},f28c:function(t,e,a){"use strict";a("065a")},f29a:function(t,e,a){"use strict";a("1883")}}]);